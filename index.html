<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Pregunta secreta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      /* sunset gradient */
      background: linear-gradient(180deg, #ff9a9e, #fecfef 30%, #f6d365 60%, #fda085 100%);
      padding: 16px;
    }

    .card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      width: 100%;
      max-width: 480px;
      border-radius: 28px;
      padding: 26px 22px 22px;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.22);
      text-align: center;
      position: relative;
      overflow: hidden;
      animation: popIn 0.6s ease-out;
    }

    @keyframes popIn {
      0% { transform: translateY(20px) scale(0.95); opacity: 0; }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }

    .avatar-circle {
      width: 70px;
      height: 70px;
      border-radius: 999px;
      margin: 0 auto 14px;
      background: radial-gradient(circle at 30% 30%, #ffe8a3, #f97373);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      color: #fff;
    }

    .bubble {
      display: inline-block;
      background: #eef2ff;
      border-radius: 18px;
      padding: 10px 16px;
      margin-bottom: 10px;
      font-size: 0.9rem;
      color: #374151;
    }

    h1 {
      font-size: 1.2rem;
      margin-bottom: 6px;
      color: #111827;
    }

    .hint {
      font-size: 0.9rem;
      color: #6b7280;
      margin-bottom: 16px;
    }

    .scramble-container {
      background: #f9fafb;
      border-radius: 18px;
      padding: 14px 10px;
      margin-bottom: 18px;
      border: 1px solid #e5e7eb;
    }

    .word-row {
      display: inline-flex;
      padding: 4px 6px;
      background: #e5e7eb;
      border-radius: 999px;
      margin: 3px 4px;
    }

    .letter {
      min-width: 18px;
      padding: 4px 3px;
      margin: 0 1px;
      border-radius: 6px;
      background: white;
      border: 1px solid #d1d5db;
      font-size: 0.85rem;
      cursor: grab;
      user-select: none;
    }

    .letter:active {
      cursor: grabbing;
    }

    .buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-top: 10px;
    }

    button {
      flex: 1;
      border: none;
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.2s;
    }

    button:active {
      transform: scale(0.97);
      box-shadow: 0 4px 10px rgba(0,0,0,0.18);
    }

    .btn-yes {
      background: linear-gradient(135deg, #22c55e, #4ade80);
      color: white;
      box-shadow: 0 4px 14px rgba(34, 197, 94, 0.6);
    }

    .btn-no {
      background: rgba(255, 255, 255, 0.7);
      color: #b91c1c;
      border: 1px solid #fecaca;
    }

    .shot-missed {
      margin-top: 10px;
      font-size: 1.05rem;
      font-weight: 600;
      color: #b91c1c;
      display: none;
    }

    .restart {
      margin-top: 6px;
      font-size: 0.9rem;
      color: #6b7280;
      text-decoration: underline;
      cursor: pointer;
      display: none;
    }

    /* Fireworks / overlay */
    .fireworks {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255, 237, 213, 0.96), rgba(15, 23, 42, 0.96));
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 50;
      color: #f9fafb;
      text-align: center;
    }

    .fireworks.show {
      display: flex;
    }

    .fireworks h2 {
      font-size: 2rem;
      margin-bottom: 8px;
    }

    .fireworks p {
      font-size: 1rem;
      color: #e5e7eb;
      margin-bottom: 18px;
    }

    .secret-text {
      font-size: 0.9rem;
      color: #fde68a;
    }

    .firework {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #fff;
      animation: explode 1.3s ease-out infinite;
      opacity: 0;
    }

    @keyframes explode {
      0% { transform: translate(0,0) scale(0.2); opacity: 1; }
      70% { transform: translate(var(--dx), var(--dy)) scale(1); opacity: 1; }
      100% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="avatar-circle">‚ùì</div>
    <div class="bubble" id="bubble-text">*mensaje secreto entrante‚Ä¶*</div>

    <h1>Ordena las letras del mensaje üëá</h1>
    <p class="hint">
      Pista: tiene que ver con <strong>Love Library</strong> y estudiar conmigo üòâ
    </p>

    <div class="scramble-container" id="scramble-container">
      <!-- words and letters will be injected by JS -->
    </div>

    <div class="buttons">
      <button class="btn-yes" id="btn-yes">S√≠ üíö</button>
      <button class="btn-no" id="btn-no">No üòÖ</button>
    </div>

    <div class="shot-missed" id="shot-missed">shot missed üíî</div>
    <div class="restart" id="restart">Tocar para volver a intentar</div>
  </div>

  <!-- Fireworks overlay -->
  <div class="fireworks" id="fireworks">
    <h2>¬°Perfecto! üéÜ</h2>
    <p>Sab√≠a que ibas a decir que s√≠ üòå</p>
    <p class="secret-text">
      Mensaje completo: <br />
      <em>¬øQuieres venir a Love Library a estudiar conmigo?</em>
    </p>
    <div id="firework-container"></div>
  </div>

  <script>
    const scrambledWords = [
      "sreiuQe",      // Quieres
      "rvein",        // venir
      "a",            // a
      "voLe",         // Love
      "ryLbarLi",     // Library
      "a",            // a
      "ratseuid",     // estudiar
      "gmnoioc?"      // conmigo?
    ];

    const scrambleContainer = document.getElementById('scramble-container');
    const btnYes = document.getElementById('btn-yes');
    const btnNo = document.getElementById('btn-no');
    const fireworksOverlay = document.getElementById('fireworks');
    const fireworkContainer = document.getElementById('firework-container');
    const shotMissed = document.getElementById('shot-missed');
    const restart = document.getElementById('restart');

    let draggedLetter = null;
    let noCount = 0;

    // Build draggable letter tiles
    function buildScramble() {
      scrambleContainer.innerHTML = "";
      scrambledWords.forEach(word => {
        const wordRow = document.createElement('div');
        wordRow.className = 'word-row';

        word.split("").forEach(ch => {
          const span = document.createElement('span');
          span.className = 'letter';
          span.textContent = ch;
          span.draggable = true;

          span.addEventListener('dragstart', (e) => {
            draggedLetter = span;
          });

          span.addEventListener('dragover', (e) => {
            e.preventDefault();
          });

          span.addEventListener('drop', (e) => {
            e.preventDefault();
            if (!draggedLetter || draggedLetter === span) return;
            const parent = span.parentNode;
            const draggedIndex = Array.from(parent.children).indexOf(draggedLetter);
            const targetIndex = Array.from(parent.children).indexOf(span);

            if (draggedIndex < targetIndex) {
              parent.insertBefore(draggedLetter, span.nextSibling);
            } else {
              parent.insertBefore(draggedLetter, span);
            }
          });

          wordRow.appendChild(span);
        });

        scrambleContainer.appendChild(wordRow);
      });
    }

    function showFireworks() {
      fireworksOverlay.classList.add('show');
      fireworkContainer.innerHTML = "";

      for (let i = 0; i < 45; i++) {
        const fw = document.createElement('div');
        fw.className = 'firework';
        const angle = Math.random() * 2 * Math.PI;
        const distance = 80 + Math.random() * 140;
        const dx = Math.cos(angle) * distance;
        const dy = Math.sin(angle) * distance;

        fw.style.setProperty('--dx', dx + 'px');
        fw.style.setProperty('--dy', dy + 'px');

        // sunset-ish colors
        const colors = ["#fbbf24", "#f97316", "#fb7185", "#22c55e", "#38bdf8"];
        fw.style.background = colors[Math.floor(Math.random() * colors.length)];
        fw.style.animationDelay = (Math.random() * 0.9) + 's';

        fw.style.left = '50%';
        fw.style.top = '50%';
        fireworkContainer.appendChild(fw);
      }
    }

    function resetState() {
      noCount = 0;
      shotMissed.style.display = "none";
      restart.style.display = "none";
      fireworksOverlay.classList.remove('show');
      buildScramble();
    }

    btnYes.addEventListener('click', () => {
      showFireworks();
    });

    btnNo.addEventListener('click', () => {
      if (noCount === 0) {
        noCount = 1;
        btnYes.textContent = "Ok, juego que s√≠ üí´";
        btnNo.textContent = "No todav√≠a";
      } else {
        shotMissed.style.display = "block";
        restart.style.display = "block";
      }
    });

    restart.addEventListener('click', resetState);

    // init
    buildScramble();
  </script>
</body>
</html>
